# NationOS PWA .htaccess Configuration
# For Namecheap Shared Hosting (Apache)

# Force correct MIME types for PWA critical files
<IfModule mod_mime.c>
    AddType application/manifest+json .webmanifest .json
    AddType application/json .json
    AddType image/x-icon .ico
    AddType image/png .png
    AddType text/javascript .js
    AddType text/css .css
</IfModule>

# Enable mod_headers for setting custom headers
<IfModule mod_headers.c>
    # Set caching headers for static assets (Icons, JS, CSS) - Cache for 1 year
    <FilesMatch "\.(ico|png|jpg|jpeg|svg|webp|gif)$">
        Header set Cache-Control "max-age=31536000, public, immutable"
    </FilesMatch>

    <FilesMatch "\.(css|js)$">
        Header set Cache-Control "max-age=31536000, public, immutable"
    </FilesMatch>

    # Manifest file - cache but allow revalidation
    <FilesMatch "manifest\.json$">
        Header set Cache-Control "max-age=86400, public"
        Header set Content-Type "application/manifest+json"
    </FilesMatch>

    # Service Worker - NEVER cache (must always be fresh)
    <Files "sw.js">
        Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
        Header set Service-Worker-Allowed "/"
    </Files>

    # HTML files - don't cache (so updates are immediate)
    <FilesMatch "\.html$">
        Header set Cache-Control "max-age=0, no-cache, must-revalidate"
    </FilesMatch>

    # Security headers
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Enable GZIP compression for better performance
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/javascript application/json application/manifest+json
</IfModule>

# Prevent directory listing
Options -Indexes

# Default charset
AddDefaultCharset UTF-8
